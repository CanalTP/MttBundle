{% extends "CanalTPMethBundle:Layouts:base_layout.html.twig" %}

{% block body %}

    <div id="layout-1-wrapper">
        <div class="layout-container">
            <div id="header" class="clearfix">
                <div id="direction-title-wrapper" data-block-level="line" data-auto-filled="1">
                    {% if line.title is defined %}
                        {{ line.title }}
                    {% endif %}
                </div>
                <div id="stop-point-title-wrapper" data-block-level="stop_point" data-auto-filled="1">
                    {% if stopPoint is defined %}
                        <div class="bold">{{'stop_point.label'|trans({}, 'default')}}:</div> {{ stopPoint.title }}
                    {% endif %}
                </div>
            </div>
            <div id="map-wrapper" class="clearfix">
                <div id="line_map_block" data-block-level="line" data-block-type="img" class="block">
                {% set block = attribute(line.blocks, 'line_map_block') %}
                {% if block %}
                    <img class="line_map_img" src="{{ block.content }}" title="{{ block.title }}" title="{{ block.alt }}" />
                {% endif %}
                </div>
                <div id="small-right-blocks">
                    {% for i in 1..4 %}
                        {% set id = 'text_block_' ~ i %}
                        {% set block = attribute(line.blocks, id) %}
                        <div id="{{ id }}" data-block-level="{% if i == 4 %}stop_point{% else %}line{% endif %}" data-block-type="text" class="small-block block">
                            {% if block %}
                                <div class="title">{{ block.title }}</div>
                                <div class="content">{{ block.content|nl2br }}</div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div id="timetables-wrapper" class="row">
                <div data-block-level="stop_point" class="timetable-container block col-md-6"></div>
                <div data-block-level="stop_point" class="timetable-container block col-md-6"></div>
                <div data-block-level="stop_point" class="timetable-container block col-md-6"></div>
                <div data-block-level="stop_point" class="timetable-container block col-md-6"></div>
            </div>
        </div>
    </div>
{% endblock %}


{% block scripts %}
    <script>
    require(['meth_layout'], function(Meth_Layout){
        var layout = Meth_Layout.init($('#layout-1-wrapper'), {{ blockTypes|json_encode()|raw }}, {{line.id}}, {{stopPointLevel|json_encode()|raw}});
    });
    </script>
{% endblock %}
